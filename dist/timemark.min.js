function timeFormat(e, t) {
  var r = new Date(e),
    a = {
      'M+': r.getMonth() + 1,
      'd+': r.getDate(),
      'h+': r.getHours() % 12 == 0 ? 12 : r.getHours() % 12,
      'H+': r.getHours(),
      'm+': r.getMinutes(),
      's+': r.getSeconds(),
      'q+': Math.floor((r.getMonth() + 3) / 3),
      S: r.getMilliseconds(),
    };
  for (var g in (/(y+)/.test(t) &&
    (t = t.replace(RegExp.$1, (r.getFullYear() + '').substr(4 - RegExp.$1.length))),
  /(E+)/.test(t) &&
    (t = t.replace(
      RegExp.$1,
      (1 < RegExp.$1.length ? (2 < RegExp.$1.length ? '星期' : '周') : '') +
        { 0: '日', 1: '一', 2: '二', 3: '三', 4: '四', 5: '五', 6: '六' }[r.getDay() + '']
    )),
  a))
    new RegExp('(' + g + ')').test(t) &&
      (t = t.replace(
        RegExp.$1,
        1 == RegExp.$1.length ? a[g] : ('00' + a[g]).substr(('' + a[g]).length)
      ));
  return t;
}
var timemark = function(e, t) {
  t = t || new Date();
  var r = Date.parse(new Date(e));
  r = Math.floor(r / 86400 / 1e3);
  var a = Date.parse(new Date(t)),
    g = r - (a = Math.floor(a / 86400 / 1e3));
  return -1 === g
    ? '昨天'
    : 0 === g
    ? '今天'
    : 1 === g
    ? '明天'
    : 2 === g
    ? '后天'
    : timeFormat(e, g <= 7 && 2 < g ? 'EE' : 'yyyy-MM-dd');
};
module.exports = timemark;
